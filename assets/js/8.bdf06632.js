(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{444:function(t,s,e){"use strict";e.r(s);var a=e(14),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"working-with-custom-chains"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#working-with-custom-chains"}},[t._v("#")]),t._v(" Working with custom chains")]),t._v(" "),e("p",[t._v("Given Alan.dart now works primarily based on Protobuf, in order to use it with a custom chain you will need to generate the proper files. This will make sure you are able to create transactions containing custom messages or to query the chain for custom modules. Following, you can find how to do this.")]),t._v(" "),e("h2",{attrs:{id:"generating-custom-protobuf-implementations"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#generating-custom-protobuf-implementations"}},[t._v("#")]),t._v(" Generating custom Protobuf implementations")]),t._v(" "),e("h3",{attrs:{id:"_1-get-the-proto-files"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-get-the-proto-files"}},[t._v("#")]),t._v(" 1. Get the "),e("code",[t._v(".proto")]),t._v(" files")]),t._v(" "),e("p",[t._v("The first thing you have to do is to get the "),e("code",[t._v(".proto")]),t._v(" files necessary to compile everything. Most custom chains include those files into two separate folders: "),e("code",[t._v("proto")]),t._v(" and "),e("code",[t._v("third_party")]),t._v(":")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("inside the "),e("code",[t._v("proto")]),t._v(" folder you can usually find the various "),e("code",[t._v(".proto")]),t._v(" files that are used to generate custom messages, queriers, etc;")])]),t._v(" "),e("li",[e("p",[t._v("inside the "),e("code",[t._v("third_party")]),t._v(", instead, you can find all the other "),e("code",[t._v(".proto")]),t._v(" files that are taken from third party projects (such as Protobuf, Google, Cosmos, etc) and are still required to compile the custom ones.")])])]),t._v(" "),e("p",[t._v("That being said, what you want to do is get those two folders ("),e("code",[t._v("proto")]),t._v(" and "),e("code",[t._v("third_party")]),t._v(") and put them into your project root folder. As an example, this is the folder structure of Alan.dart's root folder:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("Alan.dart\n├── proto\n│    └── cosmos\n│         ├── auth\n│         ├── bank\n│         ├── base\n│         ├── capability\n│         ├── crisis\n│         ├── crypto\n│         ├── distribution\n│         ├── evidence\n│         ├── genutil\n│         ├── gov\n│         ├── mint\n│         ├── params\n│         ├── slashing\n│         ├── staking\n│         ├── tx\n│         ├── upgrade\n│         └── vesting\n│\n├── third_party\n│    └── proto\n│         ├── confio\n│         ├── cosmos_proto\n│         ├── gogoproto\n│         ├── google\n│         └── tendermint\n├── ...\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br")])]),e("p",[t._v("As you can see, the "),e("code",[t._v("proto")]),t._v(" folder contains all the Cosmos-related "),e("code",[t._v(".proto")]),t._v(" files, while the "),e("code",[t._v("third_party")]),t._v(" contains all the "),e("code",[t._v(".proto")]),t._v(" files needed in other to compile the Cosmos ones properly.")]),t._v(" "),e("h3",{attrs:{id:"_2-generate-the-dart-files"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-generate-the-dart-files"}},[t._v("#")]),t._v(" 2. Generate the "),e("code",[t._v(".dart")]),t._v(" files.")]),t._v(" "),e("p",[t._v("Now that you have your "),e("code",[t._v(".proto")]),t._v(" files ready, it's time to generate the "),e("code",[t._v(".dart")]),t._v(" files that will contain the classes that you will be able to use with Dart.")]),t._v(" "),e("p",[t._v("To do so, the first thing you have to do is to have "),e("code",[t._v("protoc")]),t._v(" installed on your machine, as well as the Dart plugin for Protobuf. If you don't have them installed, you can get them here:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/protocolbuffers/protobuf#protocol-compiler-installation",target:"_blank",rel:"noopener noreferrer"}},[t._v("Protobuf compiler ("),e("code",[t._v("protoc")]),t._v(")"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://pub.dev/packages/protoc_plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dart "),e("code",[t._v("protoc")]),t._v(" plugin"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("Once you have them installed, you can now generate your Dart files running the following script:")]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Define variables")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("OUT")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("lib/proto\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PROTO")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("proto\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("THIRD_PARTY")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("third_party\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Generate the third party Protobuf implementations")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PROTOC")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"protoc --dart_out=grpc:'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$OUT")]),t._v(" -I"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$THIRD_PARTY")]),t._v('/proto"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("proto_dirs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$THIRD_PARTY")]),t._v('/proto"')]),t._v(" -path -prune -o -name "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*.proto'")]),t._v(" -print0 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("xargs")]),t._v(" -0 -n1 "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("dirname")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniq")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[t._v("dir")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proto_dirs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PROTOC")]),t._v(" -I"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$THIRD_PARTY")]),t._v("/proto "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${dir}")]),t._v('"')]),t._v(" -maxdepth "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" -name "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*.proto'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Generate the Cosmos Protobuf implementation")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("proto_dirs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PROTO")]),t._v('"')]),t._v(" -path -prune -o -name "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*.proto'")]),t._v(" -print0 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("xargs")]),t._v(" -0 -n1 "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("dirname")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniq")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[t._v("dir")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proto_dirs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PROTOC")]),t._v(" -I"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PROTO")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --gocosmos_out"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("plugins"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("interfacetype+grpc,"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nMgoogle/protobuf/any.proto"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("github.com/cosmos/cosmos-sdk/codec/types:. "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${dir}")]),t._v('"')]),t._v(" -maxdepth "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" -name "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*.proto'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Remove all .pbserver.dart files as they are unnecessary")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$OUT")]),t._v('"')]),t._v(" -name "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*.pbserver.dart"')]),t._v(" -type f -delete\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br")])]),e("p",[t._v("As you can see, this script uses three variables:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("OUT")]),t._v(", which represents the folder inside which all the "),e("code",[t._v(".dart")]),t._v(" files will be put once generated;")]),t._v(" "),e("li",[e("code",[t._v("PROTO")]),t._v(", which is the path to the "),e("code",[t._v(".proto")]),t._v(" files that should be used to generate your custom types;")]),t._v(" "),e("li",[e("code",[t._v("THIRD_PARTY")]),t._v(", which is the folder inside which you have placed third parties' "),e("code",[t._v(".proto")]),t._v(" files.")])]),t._v(" "),e("h2",{attrs:{id:"build-errors"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#build-errors"}},[t._v("#")]),t._v(" Build errors")]),t._v(" "),e("p",[t._v("It might happen that, after you have generated all your files, some errors pop up while building the project. The most commons are the ones like the following:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("Error when reading 'lib/proto/google/protobuf/timestamp.pb.dart': No such file or directory\nimport '../../google/protobuf/timestamp.pb.dart' as $3;\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("Such errors appear if you did not include all the required "),e("code",[t._v(".proto")]),t._v(" files inside the "),e("code",[t._v("third_party")]),t._v(" folder. In the example above, we can see that it was not possible to build the project because the "),e("code",[t._v("../google/protobuf/timestamp.pb.dart")]),t._v(" file does not exist.")]),t._v(" "),e("p",[t._v("To solve this problem, the easiest way is to simply download the get "),e("code",[t._v(".proto")]),t._v(" file and put into the appropriate folder. In this case, we should download the "),e("code",[t._v("timestamp.proto")]),t._v(" file and put inside the "),e("code",[t._v("third_party/proto/google/protobuf")]),t._v(" folder:")]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" https://raw.githubusercontent.com/protocolbuffers/protobuf/master/src/google/protobuf/timestamp.proto "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" third_party/proto/google/protobuf/timestamp.proto\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("Once we have done so, we can simply re-run our generation script and make sure that everything builds properly.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Common missing files")]),t._v(" "),e("p",[t._v("The most common missing files are the ones associated with two external dependencies that are highly used inside Cosmos: Protobuf and the Google APIs. If you are missing one or more files from either of those two projects, you can find all the files here:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/protocolbuffers/protobuf/tree/master/src/google/protobuf",target:"_blank",rel:"noopener noreferrer"}},[t._v("Protobuf"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/googleapis/googleapis",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google APIs"),e("OutboundLink")],1)])])])])}),[],!1,null,null,null);s.default=r.exports}}]);